<!DOCTYPE html>













 
 
 
 
 





<html>
  <head>
    
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Coding Basics - Deferred Binding  - Google Web Toolkit - Google Code</title>
<script type="text/javascript"><!--
(function(){function a(){this.t={};this.tick=function(c){this.t[c]=(new Date).getTime()};this.tick("start")}var b=new a;window.jstiming={Timer:a,load:b};if(window.external&&window.external.pageT)window.jstiming.pt=window.external.pageT;})();

var _tocPath_ = '/webtoolkit/_doc_toc.ezt';
var codesite_token = null;
var logged_in_user_email = null;
//--></script>
<link href="/css/codesite.pack.04102009.css" type="text/css" rel="stylesheet">
<script src="/js/codesite_head.pack.04102009.js" type="text/javascript"></script>
<script type="text/javascript">CODESITE_CSITimer['load'].tick('bhs');</script>
<link rel="search" type="application/opensearchdescription+xml" title="Google Code" href="/osd.xml">

<!--[if IE]><link rel="stylesheet" type="text/css" href="/css/iehacks.css"><![endif]-->

    <link href="/css/semantic_headers.css" rel="stylesheet" type="text/css" />
       <link href="/webtoolkit/css/local_extensions.css" rel="stylesheet" type="text/css"/>
  </head>

  <body class="gc-documentation">
    
    

    <div id="gb">
 <span>
  
   
    <a href="#"
       id="projects-dropdown" onclick="return false;"
       ><span style="text-decoration:underline">My favorites</span> <span style="font-size:.75em;">&#9660;</span></a>
    |
  
    <a id="lang-dropdown" href="/" onclick="return false;"><span style="text-decoration:underline">English</span> <span style="font-size:.75em;">&#9660;</span></a>
  
   
    | <a href="https://www.google.com/accounts/Login?continue=http%3A%2F%2Fcode.google.com%2Fwebtoolkit%2Fdoc%2Flatest%2FDevGuideCodingBasicsDeferred.html&amp;followup=http%3A%2F%2Fcode.google.com%2Fwebtoolkit%2Fdoc%2Flatest%2FDevGuideCodingBasicsDeferred.html" onclick="CODESITE_click('/gb/sc/signin');"><span style="style:text-decoration:underline">Sign in</span></a>
   
  
 </span>
</div>

<div class="gbh" style="left:0px;"></div>
<div class="gbh" style="right:0px;"></div>

<div id="gc-container">
<a id="top"></a>
<div id="skipto">
  <a href="#gc-pagecontent">Skip to page content</a>
  <a href="#gc-toc">Skip to main navigation</a>
</div>

<div id="gc-header">
  <div id="logo"><a href="/">
  
  
     <img src="//www.google.com/images/logos/code_logo.gif" height="40" width="167" alt="Google Code" style="border:0;margin:3px 0 0 0;">
  
  
  </a></div>
  <div id="search">
    <div id="searchForm" class="searchForm">
      <form id="cse" action="http://www.google.com/cse" accept-charset="utf-8" class="gsc-search-box" onsubmit="executeGSearch(document.getElementById('gsearchInput').value); return false;">
      <noscript>
      <input type="hidden" name="cref" value="http://code.google.com/cse/googlecode-context.xml">
      </noscript>
      <div id="gsc-search-box">
        <input id="gsearchInput" type="text" name="q" maxlength="2048" class="gsc-input" autocomplete="off" title="Google Code Search" style="width:345px">
        <div id="cs-searchresults" onclick="event.cancelBubble = true;"></div>
        <input title="Search" id="gsearchButton" class="gsc-search-button" name="sa" value="Search" type="submit">
        <div class="greytext">e.g. "ajax apis" or "open source"</div>
      </div>
      </form>
    </div> <!-- end searchForm -->
  </div> <!-- end search -->




</div> <!-- end gc-header -->


<div id="codesiteContent">

<a id="gc-topnav-anchor"></a>
<div id="gc-topnav">
  <h1 style="padding:0 0 0 6px;">Google Web Toolkit</h1>
  <ul id="docs" class="gc-topnav-tabs">

    <li id="home_link">
      <a href="/webtoolkit/" title="Google Web Toolkit home page">Home</a>
    </li>
  
    <li id="docs_link">
      <a href="/webtoolkit/overview.html" class="selected" title="Official Google Web Toolkit documentation">Docs</a>
    </li>
  
    <li>
      <a href="http://googlewebtoolkit.blogspot.com/" title="Official Google Web Toolkit blog">Blog</a>
    </li>
  
    <li>
      <a href="/webtoolkit/community.html" title="Community home for Google Web Toolkit">Community</a>
    </li>
  
    <li>
      <a href="/webtoolkit/terms.html" title="Google Web Toolkit terms of service">Terms</a>
    </li>
  
    <li>
      <a href="/webtoolkit/download.html" title="Download Google Web Toolkit">Download</a>
    </li>
  

  </ul>
</div> <!-- end gc-topnav -->


    <div class="g-section g-tpl-230">

      <div class="g-unit g-first" id="gc-toc">
        <ul>
  <li>
    <ul>
      <li><a href="/webtoolkit/download.html">Downloads</a></li>
    </ul>
  </li>
</ul>

<div class="line"></div>

<ul>
  <li><h2>Learn More</h2>
    <ul>
      <li><a href="/webtoolkit/overview.html">Overview</a></li>
      <li><a href="/webtoolkit/business.html">Business Apps</a></li>
      <li><a href="/webtoolkit/learnmore-sdk.html">SDK</a></li>
      <li><a href="/webtoolkit/speedtracer/">Speed Tracer</a></li>
      <li><a href="/eclipse/index.html">Plugin for Eclipse</a></li>
      <li><a href="/webtoolkit/examples/">Examples</a></li>
    </ul>
  </li>
    <li><h2>Get Started</h2>
    <ul>
      <li><a href="/webtoolkit/gettingstarted.html">SDK</a></li>
      <li><a href="/webtoolkit/usingeclipse.html">Set up Eclipse</a></li>
      <li><a href="/webtoolkit/speedtracer/get-started.html">Speed Tracer</a></li>
      <li><a href="/webtoolkit/doc/latest/tutorial/index.html">Tutorials</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/tutorial/gettingstarted.html">Get Started</a>
            <ul>
              <li><a href="/webtoolkit/doc/latest/tutorial/create.html">Create a GWT Project</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/design.html">Design the Application</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/buildui.html">Build the User Interface</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/manageevents.html">Manage Events on the Client</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/codeclient.html">Code Functionality on the Client</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/debug.html">Debug a GWT Application</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/style.html">Apply Style</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/compile.html">Compile a GWT Application</a></li>
            </ul>
          </li>
          <li><a href="/webtoolkit/doc/latest/tutorial/i18n.html">Internationalization</a></li>
          <li><a href="/webtoolkit/doc/latest/tutorial/clientserver.html">Client-Server Communication</a>
            <ul>
              <li><a href="/webtoolkit/doc/latest/tutorial/RPC.html">GWT RPC</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/JSON.html">JSON</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/JSONphp.html">JSON - PHP</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/Xsite.html">Cross-Site</a></li>
            </ul>
          </li>
          <li><a href="/webtoolkit/doc/latest/tutorial/JUnit.html">JUnit Testing</a></li>
          <li><a href="/webtoolkit/doc/latest/tutorial/appengine.html">Google App Engine</a></li>
          <li><a href="/webtoolkit/doc/latest/tutorial/mvp-architecture.html">MVP Architecture</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><h2>Documentation</h2>
    <ul>
      <li><a href="/webtoolkit/doc/latest/ReleaseNotes.html">What's Coming in 2.1?</a>
        <ul>
          <li><a href="/webtoolkit/release-notes.html">Release Notes</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideOrganizingProjects.html">Organize Projects</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideCompilingAndDebugging.html">Compile &amp; Debug</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasics.html">Coding Basics</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsClient.html">Client-Side Code</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsCompatibility.html">Compatibility with the Java Language and Libraries</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsHistory.html">History</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsFormatting.html">Number and Date Formatting</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsDelayed.html">Programming Delayed Logic</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsJSON.html">Working with JSON</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsXML.html">Working with XML</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsJSNI.html">JavaScript Native Interface (JSNI)</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsOverlay.html">JavaScript Overlay Types</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsDeferred.html">Deferred Binding</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideUi.html">Build User Interfaces</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiBrowser.html">Cross-Browser Support</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiPanels.html">Layout Using Panels</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiWidgets.html">Widgets</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiCustomWidgets.html">Creating Custom Widgets</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiDom.html">Working with the DOM</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiHandlers.html">Events and Handlers</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiCss.html">Working with CSS</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiBinder.html">Declarative UI with UiBinder</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiImageBundles.html">Bundling Image Resources</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideA11y.html">Accessibility</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideI18n.html">Internationalization</a>
        <ul>
         <li><a href="/webtoolkit/doc/latest/DevGuideI18nLocale.html">Locale</a></li>
         <li><a href="/webtoolkit/doc/latest/DevGuideI18nConstants.html">Constants</a></li>
         <li><a href="/webtoolkit/doc/latest/DevGuideI18nMessages.html">Messages</a></li>
         <li><a href="/webtoolkit/doc/latest/DevGuideI18nPluralForms.html">Plural Forms</a></li>
         <li><a href="/webtoolkit/doc/latest/DevGuideUiBinderI18n.html">UiBinder</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideServerCommunication.html">Communicate with a Server</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideTesting.html">Test with JUnit</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/DevGuideTestingHtmlUnit.html">HtmlUnit</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideTestingRemoteTesting.html">Remote Testing</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideTestingCoverage.html">Code Coverage</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideDeploying.html">Deploy</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideOptimizing.html">Optimize</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodeSplitting.html">Code Splitting</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCompileReport.html">Compile Report</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideClientBundle.html">Client Bundle</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideLightweightMetrics.html">Lightweight Metrics</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/RefGuide.html">Reference</a>
        <ul>
          <li><a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.1/index.html?overview-summary.html">SDK API Reference (Javadoc)</a></li>
          <li><a href="/webtoolkit/doc/latest/RefJreEmulation.html">JRE Emulation Reference</a></li>
          <li><a href="/webtoolkit/doc/latest/RefWidgetGallery.html">Widget List</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/FAQ.html">FAQ</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/FAQ_GettingStarted.html">Get Started</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_DebuggingAndCompiling.html">Debug and Compile</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_UI.html">Build the User Interface</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_Client.html">Develop Client-side Code</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_Server.html">Communicate with a Server</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_Troubleshooting.html">Troubleshoot</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideGlossary.html">Glossary</a></li>
      <li><a href="/webtoolkit/previousdocs.html">Docs for Previous Versions</a></li>
    </ul>
  </li>
  <li><h2>Tools</h2>
    <ul>
      <li><a href="/eclipse/">Plugin for Eclipse</a></li>    
      <li><a href="/webtoolkit/doc/latest/RefCommandLineTools.html">SDK Command-line Tools</a></li>
      <li><a href="/webtoolkit/speedtracer/">Speed Tracer</a>
        <ul>
          <li><a href="/webtoolkit/speedtracer/get-started.html">Getting Started</a></li>
          <li><a href="/webtoolkit/speedtracer/speed-tracer-examples.html">Examples</a></li>
          <li><a href="/webtoolkit/speedtracer/hint-description.html">Hints</a></li>
          <li><a href="/webtoolkit/speedtracer/data-dump-format.html">Data Dump Format</a></li>
          <li><a href="/webtoolkit/speedtracer/logging-api.html">Logging API</a></li>
          <li><a href="/webtoolkit/speedtracer/faq.html">FAQ</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/tools/gwtdesigner/index.html">GWT Designer</a></li>
      <li><a href="/webtoolkit/tools/wbpro/index.html">WindowBuilder Pro</a></li>
      <li><a href="/webtoolkit/tools/wintester/html/index.html">WindowTester Pro</a></li>
      <li><a href="/webtoolkit/tools/codepro/doc/index.html">CodePro AnalytiX</a></li>
    </ul>
  </li>



  <li><h2>Resources</h2>
    <ul>
      <li><a href="/webtoolkit/articles.html">Articles</a></li>
      <li><a href="/webtoolkit/books.html">Books</a></li>
      <li><a href="/webtoolkit/community.html">Community</a>
        <ul>
          <li><a href="http://gwtgallery.appspot.com">App Gallery</a></li>
          <li><a href="/webtoolkit/developer_spotlight.html">Developer Spotlight</a></li>
         </ul>
      </li>
      <li><a href="/webtoolkit/googleapilibraries.html">Google API Libraries</a></li>
      <li><a href="/webtoolkit/tools.html">Tools &amp; Libraries</a></li>
      <li><a href="/webtoolkit/media_gallery.html">Presentations</a></li>
      <li><a href="/webtoolkit/makinggwtbetter.html">Making GWT Better</a></li>
      <li><a href="/webtoolkit/lifeofanissue.html">Issue Tracking</a></li>
    </ul>
  </li>
</ul>



        <a class="hidden" href="#gc-topnav-anchor">More Google Web Toolkit resource links</a>
      </div>

      <div class="g-unit" id="gc-pagecontent">
        <script type="text/javascript">CODESITE_docEarlyProcessing();</script>


        <h1 class="page_title">Coding Basics - Deferred Binding </h1>



<p>Deferred binding is a feature of the GWT compiler that works by generating many versions of code at compile time, only one of which needs to be loaded by a particular client
during bootstrapping at runtime. Each version is generated on a per browser basis, along with any other axis that your application defines or uses. For example, if you were to
internationalize your application using <a href="DevGuideI18n.html">GWT's Internationalization module</a>, the GWT compiler would generate
various versions of your application per browser environment, such as &quot;Firefox in English&quot;, &quot;Firefox in French&quot;, &quot;Internet Explorer in English&quot;, etc... As a result, the deployed
JavaScript code is compact and quicker to download than hand coded JavaScript, containing only the code and resources it needs for a particular browser environment.</p>

<ol class="toc" id="pageToc">
  <li><a href="#benefits">Deferred Binding Benefits</a></li>
  <li><a href="#rules">Defining Deferred Binding Rules</a></li>
  <li><a href="#directives">Directives in Module XML files</a></li>
  <li><a href="#replacement">Deferred Binding Using Replacement</a></li>
  <li><a href="#example">Example Class Hierarchy using Replacement</a></li>
  <li><a href="#generators">Deferred Binding using Generators</a></li>
  <li><a href="#generator">Generator Configuration in Module XML</a></li>
  <li><a href="#generator-implementation">Generator Implementation</a></li>
</ol>

<h2 id="benefits">Deferred Binding Benefits</h2>

<p>Deferred Binding is a technique used by the GWT compiler to create and select a specific implementation of a class based on a set of parameters. In essence, deferred binding is
the Google Web Toolkit answer to Java reflection. It allows the GWT developer to produce several variations of their applications custom to each browser environment and have only
one of them actually downloaded and executed in the browser.</p>

<p>Deferred binding has several benefits:</p>

<ul>
<li>Reduces the size of the generated JavaScript code that a client will need to download by only including the code needed to run a particular browser/locale instance (used by
the <a href="DevGuideI18n.html">Internationalization module</a>)</li>

<li>Saves development time by automatically generating code to implement an interface or create a proxy class (used by the <a href="DevGuideServerCommunication.html#DevGuideRemoteProcedureCalls">GWT RPC module</a>)</li>

<li>Since the implementations are pre-bound at compile time, there is no run-time penalty to look up an implementation in a data structure as with dynamic binding or using virtual
functions.</li>
</ul>

<p>Some parts of the toolkit make implicit use of deferred binding, that is, they use the technique as a part of their implementation, but it is not visible to the user of the
API. For example, many <a href="DevGuideUiWidgets.html">widgets and <a href="DevGuideUiPanels.html">panels</a> as well as the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/DOM.html">DOM</a> class use this technique to implement browser specific
logic. Other GWT features require the API user to explicity invoke deferred binding by designing classes that follow specific rules and instantiating instances of the classes with <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/core/client/GWT.html#create(java.lang.Class)">GWT.create(Class)</a>, including <a href="DevGuideServerCommunication.html#DevGuideRemoteProcedureCalls">GWT RPC</a> and <a href="DevGuideI18n.html">I18N</a>.</p>

<p>As a user of the Google Web Toolkit, you may never need to create a new interface that uses deferred binding. If you follow the instructions in the guide for creating
internationalized applications or GWT RPC calls you will be using deferred binding, but you will not have to actually write any browser dependent or locale dependent code.</p>

<p>The rest of the deferred binding section describes how to create new rules and classes using deferred binding. If you are new to the toolkit or only intend to use pre-packaged
widgets, you will probably want to skip on to the next topic. If you are interested in programming entirely new widgets from the ground up or other functionality that requires
cross-browser dependent code, the next sections should be of interest.</p>

<h2 id="rules">Defining Deferred Binding Rules</h2>

<p>There are two ways in which types can be replaced via deferred binding:</p>

<ul>
<li>Replacement: A type is replaced with another depending on a set of configurable rules.</li>
<li>Code generation: A type is substituted by the result of invoking a code genreator at compile time.</li>
</ul>

<h2 id="directives">Directives in Module XML files</h2>

<p>The deferred binding mechanism is completely configurable and does not require editing the GWT distributed source code. Deferred binding is configured through the
<tt>&lt;replace-with&gt;</tt> and <tt>&lt;generate-with&gt;</tt> elements in the <a href="DevGuideOrganizingProjects.html#DevGuideModuleXml">module XML files</a>. The deferred binding
rules are pulled into the module build through <tt>&lt;inherits&gt;</tt> elements.</p>

<p>For example, the following configuration invokes deferred binding for the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/ui/PopupPanel.html">PopupPanel</a> widget:</p>

<ul>
<li>Top level <i>&lt;module&gt;</i>.gwt.xml <i><strong>inherits</strong></i> <a href="http://google-web-toolkit.googlecode.com/svn/releases/2.0/user/src/com/google/gwt/user/User.gwt.xml">com.google.gwt.user.User</a></li>

<li><a href="http://google-web-toolkit.googlecode.com/svn/releases/2.0/user/src/com/google/gwt/user/User.gwt.xml">com/google/gwt/user/User.gwt.xml</a>
<i><strong>inherits</strong></i> <a href="http://google-web-toolkit.googlecode.com/svn/releases/2.0/user/src/com/google/gwt/user/Popup.gwt.xml">com.google.gwt.user.Popup</a></li>

<li><a href="http://google-web-toolkit.googlecode.com/svn/releases/2.0/user/src/com/google/gwt/user/Popup.gwt.xml">com/google/gwt/user/Popup.gwt.xml</a>
<i><strong>contains</strong></i> <tt>&lt;replace-with&gt;</tt> elements to define deferred binding rules for the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/ui/PopupPanel.html">PopupPanel</a> class.</li>
</ul>

<p>Inside the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/ui/PopupPanel.html">PopupPanel</a> module XML file, there
happens to be some rules defined for deferred binding. In this case, we're using a replacement rule.</p>


<h2 id="replacement">Deferred Binding Using Replacement</h2>

<p>
The first type of deferred binding uses <i>replacement</i>.
Replacement means overriding the implementation of one java class with another that is determined at compile time.
For example, this technique is used to conditionalize the implementation of some widgets, such as the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/ui/PopupPanel.html">PopupPanel</a>.
The use of <tt>&lt;inherits&gt;</tt> for the <tt>PopupPanel</tt> class is shown in the previous section describing the deferred binding rules.
The actual replacement rules are specified in <tt>Popup.gwt.xml</tt>, as shown below:
</p>

<pre class="prettyprint">
&lt;module&gt;

  &lt;!--  ... other configuration omitted ... --&gt;

  &lt;!-- Fall through to this rule is the browser isn't IE or Mozilla --&gt;
  &lt;replace-with class=&quot;com.google.gwt.user.client.ui.impl.PopupImpl&quot;&gt;
    &lt;when-type-is class=&quot;com.google.gwt.user.client.ui.impl.PopupImpl&quot;/&gt;
  &lt;/replace-with&gt;

  &lt;!-- Mozilla needs a different implementation due to issue #410 --&gt;
  &lt;replace-with class=&quot;com.google.gwt.user.client.ui.impl.PopupImplMozilla&quot;&gt;
    &lt;when-type-is class=&quot;com.google.gwt.user.client.ui.impl.PopupImpl&quot; /&gt;
    &lt;any&gt;
      &lt;when-property-is name=&quot;user.agent&quot; value=&quot;gecko&quot;/&gt;
      &lt;when-property-is name=&quot;user.agent&quot; value=&quot;gecko1_8&quot; /&gt;
    &lt;/any&gt;
  &lt;/replace-with&gt;

  &lt;!-- IE has a completely different popup implementation --&gt;
  &lt;replace-with class=&quot;com.google.gwt.user.client.ui.impl.PopupImplIE6&quot;&gt;
    &lt;when-type-is class=&quot;com.google.gwt.user.client.ui.impl.PopupImpl&quot;/&gt;
    &lt;when-property-is name=&quot;user.agent&quot; value=&quot;ie6&quot; /&gt;
  &lt;/replace-with&gt;
&lt;/module&gt;
</pre>

<p>These directives tell the GWT compiler to swap out the <tt>PoupImpl</tt> class code with different class implementations according to the the <tt>user.agent</tt> property. The
<tt>Popup.gwt.xml</tt> file specifies a default implementation for the <tt>PopupImpl</tt> class, an overide for the Mozilla browser (<tt>PopupImplMozilla</tt> is substituted for
<tt>PopupImpl</tt>), and an override for Internet Explorer version 6 (<tt>PopupImplIE6</tt> is substituted for <tt>PopupImpl</tt>). Note that <tt>PopupImpl</tt> class or its
derived classes cannot be instantiated directly. Instead, the <tt>PopupPanel</tt> class is used and the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/core/client/GWT.html#create(java.lang.Class)">GWT.create(Class)</a> technique is used
under the hood to instruct the compiler to use deferred binding.</p>

<h2 id="example">Example Class Hierarchy using Replacement</h2>

<p>To see how this is used when designing a widget, we will examine the case of the <tt>PopupPanel</tt> widget further. The <tt>PopupPanel</tt> class implements the user visible
API and contains logic that is common to all browsers. It also instantiates the proper implementation specific logic using the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/core/client/GWT.html#create(java.lang.Class)">GWT.create(Class)</a> as follows:</p>

<pre class="prettyprint">
  private static final PopupImpl impl = GWT.create(PopupImpl.class);
</pre>

<p>The two classes PopupImplMozilla and PopupImplIE6 extend the PopupImpl class and override some <tt>PopupImpl</tt>'s methods to implement browser specific behavior.</p>

<p>Then, when the <tt>PopupPanel</tt> class needs to switch to some browser dependent code, it accesses a member function inside the <tt>PopupImpl</tt> class:</p>

<pre class="prettyprint">
  public void setVisible(boolean visible) {
    // ... common code for all implementations of PopupPanel ...

    // If the PopupImpl creates an iframe shim, it's also necessary to hide it
    // as well.
    impl.setVisible(getElement(), visible);
  }
</pre>

<p>The default implementation of <tt>PopupImpl.setVisible()</tt> is empty, but <tt>PopupImplIE6</tt> has some special logic implemented as a <a href="DevGuideCodingBasics.html#DevGuideJavaScriptNativeInterface">JSNI</a> method:</p>

<pre class="prettyprint">
  public native void setVisible(Element popup, boolean visible) /*-{
    if (popup.__frame) {
      popup.__frame.style.visibility = visible ? 'visible' : 'hidden';
    }
  }-*/;{
</pre>

<p>After the GWT compiler runs, it prunes out any unused code. If your application references the <tt>PopupPanel</tt> class, the compiler will create a separate JavaScript output
file for each browser, each containing only one of the implementations: <tt>PopupImpl</tt>, <tt>PopupImplIE6</tt> or <tt>PopupImplMozilla</tt>. This means that each browser only
downloads the implementation it needs, thus reducing the size of the output JavaScript code and minimizing the time needed to download your application from the server.</p>

<h2 id="generators">Deferred Binding using Generators</h2>

<p>The second technique for deferred binding consists of using <i>generators</i>. Generators are classes that are invoked by the GWT compiler to generate a Java implementation of
a class during compilation. When compiling for production mode, this generated implementation is directly translated to one of the versions of your application in JavaScript code that a
client will download based on its browser environment.</p>

<p>The following is an example of how a deferred binding generator is specified to the compiler in the <a href="DevGuideOrganizingProjects.html#DevGuideModuleXml">module XML file</a>
hierarchy for the <tt>RemoteService</tt> class - used for GWT-RPC:</p>

<ul>
<li>Top level <i>&lt;module&gt;</i>.gwt.xml <i><strong>inherits</strong></i> <a href="http://google-web-toolkit.googlecode.com/svn/releases/2.0/user/src/com/google/gwt/user/User.gwt.xml">com.google.gwt.user.User</a></li>

<li><a href="http://google-web-toolkit.googlecode.com/svn/releases/2.0/user/src/com/google/gwt/user/User.gwt.xml">com/google/gwt/user/User.gwt.xml</a>
<i><strong>inherits</strong></i> <a href="http://google-web-toolkit.googlecode.com/svn/releases/2.0/user/src/com/google/gwt/user/RemoteService.gwt.xml">com.googl.gwt.user.RemoteService</a></li>

<li><a href="http://google-web-toolkit.googlecode.com/svn/releases/2.0/user/src/com/google/gwt/user/RemoteService.gwt.xml">com/google/gwt/user/RemoteService.gwt.xml</a>
<i><strong>contains</strong></i> <tt>&lt;generates-with&gt;</tt> elements to define deferred binding rules for the <tt>RemoteService</tt> class.</li>
</ul>

<h2 id="generator">Generator Configuration in Module XML</h2>

<p>The XML element <tt>&lt;generate-with&gt;</tt> tells the compiler to use a <tt>Generator</tt> class. Here are the contents of the <tt>RemoteService.gwt.xml</tt> file relevant
to deferred binding:</p>

<pre class="prettyprint">
&lt;module&gt;

 &lt;!--  ... other configuration omitted ... --&gt;

 &lt;!-- Default warning for non-static, final fields enabled --&gt;
 &lt;set-property name=&quot;gwt.suppressNonStaticFinalFieldWarnings&quot; value=&quot;false&quot; /&gt;

 &lt;generate-with class=&quot;com.google.gwt.user.rebind.rpc.ServiceInterfaceProxyGenerator&quot;&gt;
   &lt;when-type-assignable class=&quot;com.google.gwt.user.client.rpc.RemoteService&quot; /&gt;
 &lt;/generate-with&gt;
&lt;/module&gt;
</pre>

<p>These directives instruct the GWT compiler to invoke methods in a <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/core/ext/Generator.html">Generator</a> subclass (<tt>ServiceInterfaceProxyGenerator</tt>) in order to generate special code when the deferred binding mechanism <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/core/client/GWT.html#create(java.lang.Class)">GWT.create()</a> is encountered while
compiling. In this case, if the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/core/client/GWT.html#create(java.lang.Class)">GWT.create()</a> call references an instance of <tt>RemoteService</tt> or one of its subclasses, the <tt>ServiceInterfaceProxyGenerator</tt>'s generate()` method
will be invoked.</p>

<h2 id="generator-implementation">Generator Implementation</h2>

<p>Defining a subclass of the <tt>Generator</tt> class is much like defining a plug-in to the GWT compiler. The <tt>Generator</tt> gets called to generate a Java class definition
before the Java to JavaScript conversion occurs. The implementation consists of one method that must output Java code to a file and return the name of the generated class as a
string.</p>

<p>The following code shows the <tt>Generator</tt> that is responsible for deferred binding of a <tt>RemoteService</tt> interface:</p>

<pre class="prettyprint">
/**
 * Generator for producing the asynchronous version of a
 * {@link com.google.gwt.user.client.rpc.RemoteService RemoteService} interface.
 */
public class ServiceInterfaceProxyGenerator extends Generator {

  /**
   * Generate a default constructible subclass of the requested type. The
   * generator throws &lt;code&gt;UnableToCompleteException&lt;/code&gt; if for any reason
   * it cannot provide a substitute class
   *
   * @return the name of a subclass to substitute for the requested class, or
   *         return &lt;code&gt;null&lt;/code&gt; to cause the requested type itself to be
   *         used
   *
   */
  public String generate(TreeLogger logger, GeneratorContext ctx,
      String requestedClass) throws UnableToCompleteException {

    TypeOracle typeOracle = ctx.getTypeOracle();
    assert (typeOracle != null);

    JClassType remoteService = typeOracle.findType(requestedClass);
    if (remoteService == null) {
      logger.log(TreeLogger.ERROR, &quot;Unable to find metadata for type '&quot;
          + requestedClass + &quot;'&quot;, null);
      throw new UnableToCompleteException();
    }

    if (remoteService.isInterface() == null) {
      logger.log(TreeLogger.ERROR, remoteService.getQualifiedSourceName()
          + &quot; is not an interface&quot;, null);
      throw new UnableToCompleteException();
    }

    ProxyCreator proxyCreator = new ProxyCreator(remoteService);

    TreeLogger proxyLogger = logger.branch(TreeLogger.DEBUG,
        &quot;Generating client proxy for remote service interface '&quot;
            + remoteService.getQualifiedSourceName() + &quot;'&quot;, null);

    return proxyCreator.create(proxyLogger, ctx);
  }
}
</pre>

<p>The <tt>typeOracle</tt> is an object that contains information about the Java code that has already been parsed that the generator may need to consult. In this case, the
<tt>generate()</tt> method checks it arguments and the passes off the bulk of the work to another class (<tt>ProxyCreator</tt>).</p>



      </div><!-- end gc-pagecontent -->
   </div><!-- end gooey wrapper -->

    </div> <!-- end codesite content -->


<div id="gc-footer" dir="ltr">
  <div class="text">
    
      <div class="notice"><div id="notice" style="text-align: center; border: 1em 0em 1em 0em">
  Except as otherwise <a
  href="http://code.google.com/policies.html#restrictions">noted</a>,
  the content of this page is licensed under the <a rel="license"
  href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
  Attribution 3.0 License</a>.
<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" 
              xmlns:dc="http://purl.org/dc/elements/1.1/"
              xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <Work rdf:about="">
    <license rdf:resource="http://creativecommons.org/licenses/by/3.0/" />
  </Work>
  <License rdf:about="http://creativecommons.org/licenses/by/3.0/">
    <permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
    <permits rdf:resource="http://web.resource.org/cc/Distribution"/>
    <requires rdf:resource="http://web.resource.org/cc/Notice"/>
    <requires rdf:resource="http://web.resource.org/cc/Attribution"/>
    <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks"/>
  </License>
</rdf:RDF> -->
</div>
</div>
    
    &copy;2010 Google -
    <a href="/">Code Home</a> -
    <a href="/terms.html">Terms of Service</a> -
    <a href="/privacy.html">Privacy Policy</a> -
    <a href="/more/">Site Directory</a>
    <br> <br>
    Google Code offered in:
    <a href="/intl/en/">English</a> -
    <a href="/intl/es/">Español</a> -
    <a href="/intl/ja/">日本語</a> -
    <a href="/intl/ko/">한국어</a> -
    <a href="/intl/pt-BR/">Português</a> -
    <a href="/intl/ru/">Pусский</a> -
    <a href="/intl/zh-CN/">中文(简体)</a> -
    <a href="/intl/zh-TW/">中文(繁體)</a>
  </div>
</div><!-- end gc-footer -->

</div><!-- end gc-container -->

<script type="text/javascript">CODESITE_CSITimer['load'].tick('ats');</script>
<script src="/js/codesite_tail.pack.04102009.js" type="text/javascript"></script>




<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(


    ['siteTracker._setAccount', 'UA-18071-1'],
    ['siteTracker._setDomainName', 'code.google.com'],
    ['siteTracker._setCookiePath', window.location.pathname.substring(0,
        window.location.pathname.lastIndexOf('/') + 1)],
    ['siteTracker._trackPageview']
);
(function() {
  var ga = document.createElement('script');

  ga.type = 'text/javascript';
  ga.async = true;
  ga.src = 'http://www.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] ||
   document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
</script>




  </body>
</html>

