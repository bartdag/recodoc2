<!DOCTYPE html>













 
 
 
 
 





<html>
  <head>
    
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Coding Basics - Programming Delayed Logic - Google Web Toolkit - Google Code</title>
<script type="text/javascript"><!--
(function(){function a(){this.t={};this.tick=function(c){this.t[c]=(new Date).getTime()};this.tick("start")}var b=new a;window.jstiming={Timer:a,load:b};if(window.external&&window.external.pageT)window.jstiming.pt=window.external.pageT;})();

var _tocPath_ = '/webtoolkit/_doc_toc.ezt';
var codesite_token = null;
var logged_in_user_email = null;
//--></script>
<link href="/css/codesite.pack.04102009.css" type="text/css" rel="stylesheet">
<script src="/js/codesite_head.pack.04102009.js" type="text/javascript"></script>
<script type="text/javascript">CODESITE_CSITimer['load'].tick('bhs');</script>
<link rel="search" type="application/opensearchdescription+xml" title="Google Code" href="/osd.xml">

<!--[if IE]><link rel="stylesheet" type="text/css" href="/css/iehacks.css"><![endif]-->

    <link href="/css/semantic_headers.css" rel="stylesheet" type="text/css" />
       <link href="/webtoolkit/css/local_extensions.css" rel="stylesheet" type="text/css"/>
  </head>

  <body class="gc-documentation">
    
    

    <div id="gb">
 <span>
  
   
    <a href="#"
       id="projects-dropdown" onclick="return false;"
       ><span style="text-decoration:underline">My favorites</span> <span style="font-size:.75em;">&#9660;</span></a>
    |
  
    <a id="lang-dropdown" href="/" onclick="return false;"><span style="text-decoration:underline">English</span> <span style="font-size:.75em;">&#9660;</span></a>
  
   
    | <a href="https://www.google.com/accounts/Login?continue=http%3A%2F%2Fcode.google.com%2Fwebtoolkit%2Fdoc%2Flatest%2FDevGuideCodingBasicsDelayed.html&amp;followup=http%3A%2F%2Fcode.google.com%2Fwebtoolkit%2Fdoc%2Flatest%2FDevGuideCodingBasicsDelayed.html" onclick="CODESITE_click('/gb/sc/signin');"><span style="style:text-decoration:underline">Sign in</span></a>
   
  
 </span>
</div>

<div class="gbh" style="left:0px;"></div>
<div class="gbh" style="right:0px;"></div>

<div id="gc-container">
<a id="top"></a>
<div id="skipto">
  <a href="#gc-pagecontent">Skip to page content</a>
  <a href="#gc-toc">Skip to main navigation</a>
</div>

<div id="gc-header">
  <div id="logo"><a href="/">
  
  
     <img src="//www.google.com/images/logos/code_logo.gif" height="40" width="167" alt="Google Code" style="border:0;margin:3px 0 0 0;">
  
  
  </a></div>
  <div id="search">
    <div id="searchForm" class="searchForm">
      <form id="cse" action="http://www.google.com/cse" accept-charset="utf-8" class="gsc-search-box" onsubmit="executeGSearch(document.getElementById('gsearchInput').value); return false;">
      <noscript>
      <input type="hidden" name="cref" value="http://code.google.com/cse/googlecode-context.xml">
      </noscript>
      <div id="gsc-search-box">
        <input id="gsearchInput" type="text" name="q" maxlength="2048" class="gsc-input" autocomplete="off" title="Google Code Search" style="width:345px">
        <div id="cs-searchresults" onclick="event.cancelBubble = true;"></div>
        <input title="Search" id="gsearchButton" class="gsc-search-button" name="sa" value="Search" type="submit">
        <div class="greytext">e.g. "ajax apis" or "open source"</div>
      </div>
      </form>
    </div> <!-- end searchForm -->
  </div> <!-- end search -->




</div> <!-- end gc-header -->


<div id="codesiteContent">

<a id="gc-topnav-anchor"></a>
<div id="gc-topnav">
  <h1 style="padding:0 0 0 6px;">Google Web Toolkit</h1>
  <ul id="docs" class="gc-topnav-tabs">

    <li id="home_link">
      <a href="/webtoolkit/" title="Google Web Toolkit home page">Home</a>
    </li>
  
    <li id="docs_link">
      <a href="/webtoolkit/overview.html" class="selected" title="Official Google Web Toolkit documentation">Docs</a>
    </li>
  
    <li>
      <a href="http://googlewebtoolkit.blogspot.com/" title="Official Google Web Toolkit blog">Blog</a>
    </li>
  
    <li>
      <a href="/webtoolkit/community.html" title="Community home for Google Web Toolkit">Community</a>
    </li>
  
    <li>
      <a href="/webtoolkit/terms.html" title="Google Web Toolkit terms of service">Terms</a>
    </li>
  
    <li>
      <a href="/webtoolkit/download.html" title="Download Google Web Toolkit">Download</a>
    </li>
  

  </ul>
</div> <!-- end gc-topnav -->


    <div class="g-section g-tpl-230">

      <div class="g-unit g-first" id="gc-toc">
        <ul>
  <li>
    <ul>
      <li><a href="/webtoolkit/download.html">Downloads</a></li>
    </ul>
  </li>
</ul>

<div class="line"></div>

<ul>
  <li><h2>Learn More</h2>
    <ul>
      <li><a href="/webtoolkit/overview.html">Overview</a></li>
      <li><a href="/webtoolkit/business.html">Business Apps</a></li>
      <li><a href="/webtoolkit/learnmore-sdk.html">SDK</a></li>
      <li><a href="/webtoolkit/speedtracer/">Speed Tracer</a></li>
      <li><a href="/eclipse/index.html">Plugin for Eclipse</a></li>
      <li><a href="/webtoolkit/examples/">Examples</a></li>
    </ul>
  </li>
    <li><h2>Get Started</h2>
    <ul>
      <li><a href="/webtoolkit/gettingstarted.html">SDK</a></li>
      <li><a href="/webtoolkit/usingeclipse.html">Set up Eclipse</a></li>
      <li><a href="/webtoolkit/speedtracer/get-started.html">Speed Tracer</a></li>
      <li><a href="/webtoolkit/doc/latest/tutorial/index.html">Tutorials</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/tutorial/gettingstarted.html">Get Started</a>
            <ul>
              <li><a href="/webtoolkit/doc/latest/tutorial/create.html">Create a GWT Project</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/design.html">Design the Application</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/buildui.html">Build the User Interface</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/manageevents.html">Manage Events on the Client</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/codeclient.html">Code Functionality on the Client</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/debug.html">Debug a GWT Application</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/style.html">Apply Style</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/compile.html">Compile a GWT Application</a></li>
            </ul>
          </li>
          <li><a href="/webtoolkit/doc/latest/tutorial/i18n.html">Internationalization</a></li>
          <li><a href="/webtoolkit/doc/latest/tutorial/clientserver.html">Client-Server Communication</a>
            <ul>
              <li><a href="/webtoolkit/doc/latest/tutorial/RPC.html">GWT RPC</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/JSON.html">JSON</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/JSONphp.html">JSON - PHP</a></li>
              <li><a href="/webtoolkit/doc/latest/tutorial/Xsite.html">Cross-Site</a></li>
            </ul>
          </li>
          <li><a href="/webtoolkit/doc/latest/tutorial/JUnit.html">JUnit Testing</a></li>
          <li><a href="/webtoolkit/doc/latest/tutorial/appengine.html">Google App Engine</a></li>
          <li><a href="/webtoolkit/doc/latest/tutorial/mvp-architecture.html">MVP Architecture</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><h2>Documentation</h2>
    <ul>
      <li><a href="/webtoolkit/doc/latest/ReleaseNotes.html">What's Coming in 2.1?</a>
        <ul>
          <li><a href="/webtoolkit/release-notes.html">Release Notes</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideOrganizingProjects.html">Organize Projects</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideCompilingAndDebugging.html">Compile &amp; Debug</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasics.html">Coding Basics</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsClient.html">Client-Side Code</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsCompatibility.html">Compatibility with the Java Language and Libraries</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsHistory.html">History</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsFormatting.html">Number and Date Formatting</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsDelayed.html">Programming Delayed Logic</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsJSON.html">Working with JSON</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsXML.html">Working with XML</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsJSNI.html">JavaScript Native Interface (JSNI)</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsOverlay.html">JavaScript Overlay Types</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodingBasicsDeferred.html">Deferred Binding</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideUi.html">Build User Interfaces</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiBrowser.html">Cross-Browser Support</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiPanels.html">Layout Using Panels</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiWidgets.html">Widgets</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiCustomWidgets.html">Creating Custom Widgets</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiDom.html">Working with the DOM</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiHandlers.html">Events and Handlers</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiCss.html">Working with CSS</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiBinder.html">Declarative UI with UiBinder</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideUiImageBundles.html">Bundling Image Resources</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideA11y.html">Accessibility</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideI18n.html">Internationalization</a>
        <ul>
         <li><a href="/webtoolkit/doc/latest/DevGuideI18nLocale.html">Locale</a></li>
         <li><a href="/webtoolkit/doc/latest/DevGuideI18nConstants.html">Constants</a></li>
         <li><a href="/webtoolkit/doc/latest/DevGuideI18nMessages.html">Messages</a></li>
         <li><a href="/webtoolkit/doc/latest/DevGuideI18nPluralForms.html">Plural Forms</a></li>
         <li><a href="/webtoolkit/doc/latest/DevGuideUiBinderI18n.html">UiBinder</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideServerCommunication.html">Communicate with a Server</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideTesting.html">Test with JUnit</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/DevGuideTestingHtmlUnit.html">HtmlUnit</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideTestingRemoteTesting.html">Remote Testing</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideTestingCoverage.html">Code Coverage</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideDeploying.html">Deploy</a></li>
      <li><a href="/webtoolkit/doc/latest/DevGuideOptimizing.html">Optimize</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/DevGuideCodeSplitting.html">Code Splitting</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideCompileReport.html">Compile Report</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideClientBundle.html">Client Bundle</a></li>
          <li><a href="/webtoolkit/doc/latest/DevGuideLightweightMetrics.html">Lightweight Metrics</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/RefGuide.html">Reference</a>
        <ul>
          <li><a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.1/index.html?overview-summary.html">SDK API Reference (Javadoc)</a></li>
          <li><a href="/webtoolkit/doc/latest/RefJreEmulation.html">JRE Emulation Reference</a></li>
          <li><a href="/webtoolkit/doc/latest/RefWidgetGallery.html">Widget List</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/FAQ.html">FAQ</a>
        <ul>
          <li><a href="/webtoolkit/doc/latest/FAQ_GettingStarted.html">Get Started</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_DebuggingAndCompiling.html">Debug and Compile</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_UI.html">Build the User Interface</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_Client.html">Develop Client-side Code</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_Server.html">Communicate with a Server</a></li>
          <li><a href="/webtoolkit/doc/latest/FAQ_Troubleshooting.html">Troubleshoot</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/doc/latest/DevGuideGlossary.html">Glossary</a></li>
      <li><a href="/webtoolkit/previousdocs.html">Docs for Previous Versions</a></li>
    </ul>
  </li>
  <li><h2>Tools</h2>
    <ul>
      <li><a href="/eclipse/">Plugin for Eclipse</a></li>    
      <li><a href="/webtoolkit/doc/latest/RefCommandLineTools.html">SDK Command-line Tools</a></li>
      <li><a href="/webtoolkit/speedtracer/">Speed Tracer</a>
        <ul>
          <li><a href="/webtoolkit/speedtracer/get-started.html">Getting Started</a></li>
          <li><a href="/webtoolkit/speedtracer/speed-tracer-examples.html">Examples</a></li>
          <li><a href="/webtoolkit/speedtracer/hint-description.html">Hints</a></li>
          <li><a href="/webtoolkit/speedtracer/data-dump-format.html">Data Dump Format</a></li>
          <li><a href="/webtoolkit/speedtracer/logging-api.html">Logging API</a></li>
          <li><a href="/webtoolkit/speedtracer/faq.html">FAQ</a></li>
        </ul>
      </li>
      <li><a href="/webtoolkit/tools/gwtdesigner/index.html">GWT Designer</a></li>
      <li><a href="/webtoolkit/tools/wbpro/index.html">WindowBuilder Pro</a></li>
      <li><a href="/webtoolkit/tools/wintester/html/index.html">WindowTester Pro</a></li>
      <li><a href="/webtoolkit/tools/codepro/doc/index.html">CodePro AnalytiX</a></li>
    </ul>
  </li>



  <li><h2>Resources</h2>
    <ul>
      <li><a href="/webtoolkit/articles.html">Articles</a></li>
      <li><a href="/webtoolkit/books.html">Books</a></li>
      <li><a href="/webtoolkit/community.html">Community</a>
        <ul>
          <li><a href="http://gwtgallery.appspot.com">App Gallery</a></li>
          <li><a href="/webtoolkit/developer_spotlight.html">Developer Spotlight</a></li>
         </ul>
      </li>
      <li><a href="/webtoolkit/googleapilibraries.html">Google API Libraries</a></li>
      <li><a href="/webtoolkit/tools.html">Tools &amp; Libraries</a></li>
      <li><a href="/webtoolkit/media_gallery.html">Presentations</a></li>
      <li><a href="/webtoolkit/makinggwtbetter.html">Making GWT Better</a></li>
      <li><a href="/webtoolkit/lifeofanissue.html">Issue Tracking</a></li>
    </ul>
  </li>
</ul>



        <a class="hidden" href="#gc-topnav-anchor">More Google Web Toolkit resource links</a>
      </div>

      <div class="g-unit" id="gc-pagecontent">
        <script type="text/javascript">CODESITE_docEarlyProcessing();</script>


        <h1 class="page_title">Coding Basics - Programming Delayed Logic</h1>



<p>Do you need to do any of the following?</p>

<ul>
<li>schedule an activity for some time in the future</li>

<li>periodically query the server or update the interface</li>

<li>queue up work to do that must wait for other initialization to finish</li>

<li>perform a large amount of computation</li>
</ul>

<p>GWT provides three classes that you can use to defer running code until a later point in time: Timer, DeferredCommand, and IncrementalCommand.</p>

<ol class="toc" id="pageToc">
  <li><a href="#timer">Scheduling work: the Timer class</a>
    <ul>
      <li><a href="#timeout">Creating Timeout Logic</a></li>
      <li><a href="#running">Periodically Running Logic</a></li>
    </ul>
  </li>
  <li><a href="#deferred">Deferring some logic into the immediate future: the DeferredCommand class</a></li>
  <li><a href="#incremental">Avoiding Slow Script Warnings: the IncrementalCommand class</a></li>
</ol>

<h2 id="timer">Scheduling work: the Timer class</h2>

<p>Use the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/Timer.html">Timer</a> class to schedule work to be done in
the future.</p>

<p>To create a timer, create a new instance of the Timer class and then override the run() method entry point.</p>

<pre class="prettyprint">
   Timer timer = new Timer() {
      public void run() {
    Window.alert (&quot;Timer expired!&quot;);
      }
    };

    // Execute the timer to expire 2 seconds in the future
    timer.schedule(2000);
</pre>

<p>Notice that the timer will not have a chance to execute the run() method until after control returns to the JavaScript event loop.</p>

<h3 id="timeout">Creating Timeout Logic</h3>

<p>One typical use for a timer is to timeout a long running command. There are a few rules of thumb to remember in this situation:</p>

<ul>
<li>Store the timer in an instance variable.</li>

<li>Always check to see that the timer is not currently running before starting a new one. (Check the instance variable to see that it is null.)</li>

<li>Remember to cancel the timer when the command completes successfully.</li>

<li>Always set the instance variable to null when the command completes or the timer expires.</li>
</ul>

<p>Below is a an example of using a timeout with a <a href="DevGuideServerCommunication.html#DevGuideRemoteProcedureCalls">Remote Procedure Call</a> (RPC).</p>

<pre class="prettyprint">
import com.google.gwt.user.client.Timer;
import com.google.gwt.user.client.Window;
import com.google.gwt.user.client.rpc.AsyncCallback;

public class Foo {

  // A keeper of the timer instance in case we need to cancel it
  private Timer timeoutTimer = null;

  // An indicator when the computation should quit
  private boolean abortFlag = false;

  static final int TIMEOUT = 30; // 30 second timeout

  void startWork () {

    // ...

    // Check to make sure the timer isn't already running.
    if (timeoutTimer != null) {
        Window.alert(&quot;Command is already running!&quot;);
        return;
    }

    // Create a timer to abort if the RPC takes too long
    timeoutTimer = new Timer() {
      public void run() {
        Window.alert(&quot;Timeout expired.&quot;);
        timeoutTimer = null;
        abortFlag = true;
      }
    };

    // (re)Initialize the abort flag and start the timer.
    abortFlag = false;
    timeoutTimer.schedule(TIMEOUT * 1000); // timeout is in milliseconds

    // Kick off an RPC
    myService.myRpcMethod(arg, new AsyncCallback() {

      public void onFailure(Throwable caught) {
         Window.alert(&quot;RPC Failed:&quot; + caught);
         cancelTimer();
      }

      public void onSuccess(Object result) {
         cancelTimer();
         if (abortFlag) {
           // Timeout already occurred. discard result
           return;
         }
         Window.alert (&quot;RPC returned: &quot;+ (String)result);
      }
    }
  }

  // Stop the timeout timer if it is running
  private void cancelTimer() {
    if (timeoutTimer != null) {
       timeoutTimer.cancel();
       timeoutTimer = null;
    }
  }
}
</pre>

<h3 id="running">Periodically Running Logic</h3>

<p>In order to keep a user interface up to date, you sometimes want to perform an update periodically. You might want to run a poll to the server to check for new data, or update
some sort of animation on the screen. In this case, use the Timer class scheduleRepeating() method:</p>

<pre class="prettyprint">
public class Foo {

  // A timer to update the elapsed time count
  private Timer elapsedTimer;
  private Label elapsedLabel = new Label();
  private long startTime;

  public Foo () {

    // ... Add elapsedLabel to a Panel ...

    // Create a new timer
    elapsedTimer = new Timer () {
      public void run() {
    showElapsed();
      }
    };

    startTime = System.currentTimeMillis();

    // Schedule the timer for every 1/2 second (500 milliseconds)
    elapsedTimer.scheduleRepeating(500);

    // ... The elapsed timer has started ...
  }

  /**
   * Show the current elapsed time in the elapsedLabel widget.
   */
  private void showElapsed () {
    double elapsedTime = (System.currentTimeMillis() - startTime) / 1000.0;
    NumberFormat n = NumberFormat.getFormat(&quot;#,##0.000&quot;);
    elapsedLabel.setText(&quot;Elapsed: &quot; + n.format(elapsedTime));
  }
}
</pre>

<h2 id="deferred">Deferring some logic into the immediate future: the DeferredCommand class</h2>

<p>Sometimes you want to break up your logic loop so that the JavaScript event loop gets a chance to run between two pieces of code. The <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/DeferredCommand.html">DeferredCommand</a> class will allow you to do that.
The logic that you pass to DeferredCommand will run at some point in the future, after control has been returned to the JavaScript event loop. This little delay may give the
interface a chance to process some user events or initialize other code. To use the DeferredCommand class in its simplest form, you create a subclass of the <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/Command.html">Command</a> class, overriding the execute() method and pass
it to DeferredCommand.addCommand().</p>

<pre class="prettyprint">

  TextBox dataEntry;

  // Set the focus on the widget after setup completes.
  DeferredCommand.addCommand(new Command() {
    public void execute () {
      dataEntry.setFocus();
    }
  }

  dataEntry = new TextBox();
</pre>

<h2 id="incremental">Avoiding Slow Script Warnings: the IncrementalCommand class</h2>

<p>AJAX developers need to be aware of keeping the browser responsive to the user. When JavaScript code is running, user interface components like buttons and text areas will not
respond to user input. If the browser were to allow this to continue, the user might think the browser is &quot;hung&quot; and be tempted to restart it. But browsers have a built-in defense
mechanism, the <i>unresponsive script warning</i>.</p>

<blockquote><img src="/webtoolkit/doc/latest/images/UnresponsiveScriptDialog.png"/></blockquote>

<p>Any script that runs without returning control to the JavaScript main event loop for more than 10 seconds or so runs the risk of having the browser popup this dialog to the
user. The dialog is there because a poorly written script might have an infinite loop or some other bug that is keeping the browser from responding. But in AJAX applications, the
script may be doing legitimate work.</p>

<p>GWT provides an <a href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/IncrementalCommand.html">IncrementalCommand</a>
class that helps perform long running calculations. It works by repeatedly calling an 'execute()' entry point until the computation is complete.</p>

<p>The following example is an outline of how to use the IncrementalCommand class to do some computation in a way that allows the browser's user interface to be responsive:</p>

<pre class="prettyprint">
public class IncrementalCommandTest implements EntryPoint {

  // Number of times doWork() is called
  static final int MAX_LOOPS = 10000;

  // Tight inner loop in doWork()
  static final int WORK_LOOP_COUNT = 50;

  // Number of times doWork() is called in IncrementalCommand before
  // returning control to the event loop
  static final int WORK_CHUNK = 100;

  // A button to kick off the computation
  Button button;

  public void onModuleLoad() {
    button = new Button(&quot;Start Computation&quot;);

    button.addClickHandler(new ClickHandler () {
      public void onClick(ClickEvent event) {
       doWorkIncremental();
      }
    }
  }

  /**
   * Create a IncrementalCommand instance that gets called back every so often
   * until all the work it has to do is complete.
   */
  private void doWorkIncremental () {

    // Turn off the button so it won't start processing again.
    button.setEnabled(false);

    IncrementalCommand ic = new IncrementalCommand(){
      int counter = 0;

      public boolean execute() {
        for (int i=0;i&lt;WORK_CHUNK;i++) {
          counter++;

          result += doWork();

          // If we have done all the work, exit with a 'false'
          // return value to terminate further execution.
          if (counter == MAX_LOOPS) {

        // Re-enable button
        button.setEnabled(true);

            // ... other end of computation processing ...

            return false;
          }
        }
        // Call the execute function again.
        return true;
      }
    };

    // Schedule the IncrementalCommand instance to run when
    // control returns to the event loop by returning 'true'
    DeferredCommand.addCommand(ic);
  }

  /**
   * Routine that keeps the CPU busy for a while.
   * @return an integer result of the calculation
   */
  private int doWork() {
    int result;

    // ... computation...

    return result;
  }
</pre>




      </div><!-- end gc-pagecontent -->
   </div><!-- end gooey wrapper -->

    </div> <!-- end codesite content -->


<div id="gc-footer" dir="ltr">
  <div class="text">
    
      <div class="notice"><div id="notice" style="text-align: center; border: 1em 0em 1em 0em">
  Except as otherwise <a
  href="http://code.google.com/policies.html#restrictions">noted</a>,
  the content of this page is licensed under the <a rel="license"
  href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
  Attribution 3.0 License</a>.
<!-- <rdf:RDF xmlns="http://web.resource.org/cc/" 
              xmlns:dc="http://purl.org/dc/elements/1.1/"
              xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <Work rdf:about="">
    <license rdf:resource="http://creativecommons.org/licenses/by/3.0/" />
  </Work>
  <License rdf:about="http://creativecommons.org/licenses/by/3.0/">
    <permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
    <permits rdf:resource="http://web.resource.org/cc/Distribution"/>
    <requires rdf:resource="http://web.resource.org/cc/Notice"/>
    <requires rdf:resource="http://web.resource.org/cc/Attribution"/>
    <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks"/>
  </License>
</rdf:RDF> -->
</div>
</div>
    
    &copy;2010 Google -
    <a href="/">Code Home</a> -
    <a href="/terms.html">Terms of Service</a> -
    <a href="/privacy.html">Privacy Policy</a> -
    <a href="/more/">Site Directory</a>
    <br> <br>
    Google Code offered in:
    <a href="/intl/en/">English</a> -
    <a href="/intl/es/">Español</a> -
    <a href="/intl/ja/">日本語</a> -
    <a href="/intl/ko/">한국어</a> -
    <a href="/intl/pt-BR/">Português</a> -
    <a href="/intl/ru/">Pусский</a> -
    <a href="/intl/zh-CN/">中文(简体)</a> -
    <a href="/intl/zh-TW/">中文(繁體)</a>
  </div>
</div><!-- end gc-footer -->

</div><!-- end gc-container -->

<script type="text/javascript">CODESITE_CSITimer['load'].tick('ats');</script>
<script src="/js/codesite_tail.pack.04102009.js" type="text/javascript"></script>




<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(


    ['siteTracker._setAccount', 'UA-18071-1'],
    ['siteTracker._setDomainName', 'code.google.com'],
    ['siteTracker._setCookiePath', window.location.pathname.substring(0,
        window.location.pathname.lastIndexOf('/') + 1)],
    ['siteTracker._trackPageview']
);
(function() {
  var ga = document.createElement('script');

  ga.type = 'text/javascript';
  ga.async = true;
  ga.src = 'http://www.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] ||
   document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
</script>




  </body>
</html>

