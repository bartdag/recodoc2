<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html lang="en-US">
    <head>
        <title>Using Customized Type Mappings (The Java&trade; Tutorials &gt;        
            JDBC(TM) Database Access &gt; JDBC Basics)
</title>

     <meta name="description" content="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform transactions" />
     <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set" />
        
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: center;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
        margin-right: 10px;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }
    
    #Footer2 {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #F90000;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #F90000;
        font-family: sans-serif;
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
    }

    /t

</style>
<script type="text/javascript">
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide the TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }
    
</script>
<noscript> 
A browser with JavaScript enabled is required for this page to operate properly.
</noscript>

    </head>
<body onload="load()">
    <div id=TopBar> <div id=TopBar_tr> <div id=TopBar_tl> <div id=TopBar_br> <div id=TopBar_bl> 
                        <div id=TopBar_right> 
                            <a target="_blank"
                                href="http://java.sun.com/javase/6/download.jsp">Download
                                the JDK</a>
                            <br>
                            <a href="../../search.html" target="_blank">Search the
                                Tutorials</a>
                            <br>
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide the TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class=PrintHeaders>
        <b>Trail:</b> JDBC(TM) Database Access
        <br><b>Lesson:</b> JDBC Basics
    </div>

    <div id=LeftBar class=LeftBar_shown>
        <div id=Contents>
            <div class="linkLESSON"><a href="index.html">JDBC Basics</a></div>
<div class="linkAHEAD"><a href="gettingstarted.html">Getting Started</a></div>
<div class="linkAHEAD"><a href="processingsqlstatements.html">Processing SQL Statements with JDBC</a></div>
<div class="linkAHEAD"><a href="connecting.html">Establishing a Connection</a></div>
<div class="linkAHEAD"><a href="sqldatasources.html">Connecting with DataSource Objects</a></div>
<div class="linkAHEAD"><a href="sqlexception.html">Handling SQLExceptions</a></div>
<div class="linkAHEAD"><a href="tables.html">Setting Up Tables</a></div>
<div class="linkAHEAD"><a href="retrieving.html">Retrieving and Modifying Values from Result Sets</a></div>
<div class="linkAHEAD"><a href="prepared.html">Using Prepared Statements</a></div>
<div class="linkAHEAD"><a href="transactions.html">Using Transactions</a></div>
<div class="linkAHEAD"><a href="rowset.html">Using RowSet Objects</a></div>
<div class="linkAHEAD"><a href="jdbcrowset.html">Using JdbcRowSet Objects</a></div>
<div class="linkAHEAD"><a href="cachedrowset.html">Using CachedRowSetObjects</a></div>
<div class="linkAHEAD"><a href="joinrowset.html">Using JoinRowSet Objects</a></div>
<div class="linkAHEAD"><a href="filteredrowset.html">Using FilteredRowSet Objects</a></div>
<div class="linkAHEAD"><a href="webrowset.html">Using WebRowSet Objects</a></div>
<div class="linkAHEAD"><a href="sqltypes.html">Using Advanced Data Types</a></div>
<div class="linkAHEAD"><a href="blob.html">Using Large Objects</a></div>
<div class="linkAHEAD"><a href="sqlxml.html">Using SQLXML Objects</a></div>
<div class="linkAHEAD"><a href="array.html">Using Array Objects</a></div>
<div class="linkAHEAD"><a href="distinct.html">Using DISTINCT Data Type</a></div>
<div class="linkAHEAD"><a href="sqlstructured.html">Using Structured Objects</a></div>
<div class="nolinkAHEAD">Using Customized Type Mappings</div>
<div class="linkAHEAD"><a href="sqldatalink.html">Using Datalink Objects</a></div>
<div class="linkAHEAD"><a href="sqlrowid.html">Using RowId Objects</a></div>
<div class="linkAHEAD"><a href="storedprocedures.html">Using Stored Procedures</a></div>
<div class="linkAHEAD"><a href="jdbcswing.html">Using JDBC with GUI API</a></div>
</div>
    </div>
    <div id=MainFlow class=MainFlow_indented>
            <span id=BreadCrumbs>
                <a href=../../index.html target=_top>Home Page</a>
                &gt;
                <a href=../index.html target=_top>JDBC(TM) Database Access</a>
                &gt;
                <a href=index.html target=_top>JDBC Basics</a>
            </span>
            <div class=NavBit>
                <a target=_top href=sqlstructured.html>&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target=_top href=../TOC.html>Trail</a>&nbsp;&bull;&nbsp;<a target=_top href=sqldatalink.html>Next&nbsp;&raquo;</a>
            </div>
            <div id=PageTitle><h1>Using Customized Type Mappings</h1></div>
            <div id=PageContent>
<!-- <h3>Using Custom Mapping</h3> -->

<p><strong>Note</strong>: MySQL and Java DB currently do not support user-defined types, structured types, or the <code>DISTINCT</code> SQL data type. Consequently, no JDBC tutorial example is available to demonstrate the features described in this section.</p>

<p>With business booming, the owner of The Coffee Break is regularly adding new stores and making changes to the database. The owner has decided to use a custom mapping for the structured type <code>ADDRESS</code>. This enables the owner to make changes to the Java class that maps the <code>ADDRESS</code> type. The Java class will have a field for each attribute of <code>ADDRESS</code>. The name of the class and the names of its fields can be any valid Java identifier.</p>

<p>The following topics are covered:</p>

<ul>
  <li><a href="#implementing_sqldata">Implementing SQLData</a></li>
  <li><a href="#using_connection_type_map">Using a Connection's Type Map</a></li>
  <li><a href="#using_your_own_type_map">Using Your Own Type Map</a></li>
</ul>

<!-- ****************************************************** -->

<h2><a name="implementing_sqldata">Implementing SQLData</a></h2>

<p>
The first thing required for a custom mapping is to create a class that implements
the interface <code>SQLData</code>.</p>

<p>
The SQL definition of the structured type <code>ADDRESS</code> looks like this:
</p>


<div class="codeblock"><pre>

  CREATE TYPE ADDRESS
  (
    NUM INTEGER,
    STREET VARCHAR(40),
    CITY VARCHAR(40),
    STATE CHAR(2),
    ZIP CHAR(5)
  );

</pre></div>


<p>
A class that implements the <code>SQLData</code> interface for the custom
mapping of the <code>ADDRESS</code> type might look like this:
</p>


<div class="codeblock"><pre>

  public class Address implements SQLData {
    public int num;
    public String street;
    public String city;
    public String state;
    public String zip;
    private String sql_type;
    public String getSQLTypeName() {
      return sql_type;
    }

    public void readSQL(SQLInput stream, String type)
                        throws SQLException {
      sql_type = type;
      num = stream.readInt();
      street = stream.readString();
      city = stream.readString();
      state = stream.readString();
      zip = stream.readString();
    }

    public void writeSQL(SQLOutput stream)
     throws SQLException {
      stream.writeInt(num);
      stream.writeString(street);
      stream.writeString(city);
      stream.writeString(state);
      stream.writeString(zip);
    }
  }

</pre></div>

<!-- ****************************************************** -->

<h2><a name="using_connection_type_map">Using a Connection's Type Map</a></h2>

<p>
After writing a class that implements the interface <code>SQLData</code>, the
only other thing you have to do to set up a custom mapping is to make an entry in
a type map. For the example, this means entering the fully qualified SQL name for the
<code>ADDRESS</code> type and the <code>Class</code> object for the class
<code>Address</code>. A type map, an instance of the <code>java.util.Map</code> interface,
is associated with every new connection when it is created, so you use that one.
Assuming that <code>con</code> is the active connection, the following
code fragment adds an entry for the UDT <code>ADDRESS</code> to the type map
associated with <code>con</code>.
</p>

<div class="codeblock"><pre>

  java.util.Map map = con.getTypeMap();
  map.put(&quot;SchemaName.ADDRESS&quot;,
           Class.forName(&quot;Address&quot;);
  con.setTypeMap(map);

</pre></div>

<p>
Whenever you call the <code>getObject</code> method to retrieve an instance of
the <code>ADDRESS</code> type, the driver will check the type map associated with the
connection and see that it has an entry for <code>ADDRESS</code>. The driver will
note the <code>Class</code> object for the <code>Address</code> class, create an instance
of it, and do many other things in the background to map <code>ADDRESS</code>
to <code>Address</code>. You do not have to do anything
more than generate the class for the mapping and then make an entry in a type map
to let the driver know that there is a custom mapping. The driver will do all the rest.
</p>

<p>
The situation is similar for storing a structured type that has a custom mapping. When
you call the method <code>setObject</code>, the driver will check to see if the value
to be set is an instance of a class that implements the interface <code>SQLData</code>.
If it is (meaning that there is a custom mapping), the driver will use the custom mapping
to convert the value to its SQL counterpart before returning it to the database. Again, the
driver does the custom mapping behind the scenes; all you need to do is supply the method
<code>setObject</code> with a parameter that has a custom mapping. You will see an
example of this later in this section.
</p>

<p>Look at the difference between working with the standard mapping,
a <code>Struct</code> object, and the custom mapping, a class in the Java
programming language. The following code fragment shows the standard
mapping to a <code>Struct</code> object, which is the mapping the driver
uses when there is no entry in the connection's type map.
</p>

<div class="codeblock"><pre>

  ResultSet rs = stmt.executeQuery(
       &quot;SELECT LOCATION WHERE STORE_NO = 100003&quot;);
  rs.next();
  Struct address = (Struct)rs.getObject(&quot;LOCATION&quot;);

</pre></div>

<p>
The variable <code>address</code> contains the following attribute
values: <code>4344</code>, <code>"First_Street"</code>, <code>"Verona"</code>,
<code>"CA"</code>, <code>"94545"</code>.
</p>

<p>
The following code fragment shows what happens when there is an entry for the
structured type <code>ADDRESS</code> in the connection's type map. Remember
that the column <code>LOCATION</code> stores values of type <code>ADDRESS</code>.
</p>

<div class="codeblock"><pre>

  ResultSet rs = stmt.executeQuery(
    &quot;SELECT LOCATION WHERE STORE_NO = 100003&quot;);
  rs.next();
  Address store_3 = (Address)rs.getObject(&quot;LOCATION&quot;);

</pre></div>

<p>
The variable <code>store_3</code>
is now an instance of the class <code>Address</code>, with each attribute value
being the current value of one of the fields of <code>Address</code>. Note that
you must remember to convert the object retrieved by the <code>getObject</code> method
to an <code>Address</code> object before assigning it to
<code>store_3</code>. Note also that <code>store_3</code>
must be an <code>Address</code> object.
</p>

<p>
Compare working with the <code>Struct</code> object to working with
the instance of the <code>Address</code> class. Suppose the store moved to a better location
in the neighboring town and therefore you must update the database. With the custom mapping, reset the fields of <code>store_3</code>, as in the
following code fragment:
</p>


<div class="codeblock"><pre>

  ResultSet rs = stmt.executeQuery(
    &quot;SELECT LOCATION WHERE STORE_NO = 100003&quot;);
  rs.next();
  Address store_3 = (Address)rs.getObject(&quot;LOCATION&quot;);
  store_3.num = 1800;
  store_3.street = &quot;Artsy_Alley&quot;;
  store_3.city = &quot;Arden&quot;;
  store_3.state = &quot;CA&quot;;
  store_3.zip = &quot;94546&quot;;
  PreparedStatement pstmt = con.prepareStatement(
         &quot;UPDATE STORES SET LOCATION = ?
           WHERE STORE_NO = 100003&quot;);
  pstmt.setObject(1, store_3);
  pstmt.executeUpdate();

</pre></div>


<p>
Values in the column <code>LOCATION</code> are instances of the <code>ADDRESS</code> type.
The driver checks the connection's type map and sees that there is an entry linking
<code>ADDRESS</code> with the class <code>Address</code> and consequently
uses the custom mapping indicated in <code>Address</code>. When the code calls the method
<code>setObject</code> with the variable <code><em>store_3</em></code> as the
second parameter, the driver checks and sees that <code><em>store_3</em></code>
represents an instance of the class <code>Address</code>, which implements
the interface <code>SQLData</code> for the structured type <code>ADDRESS</code>, and again
automatically uses the custom mapping.
</p>

<p>
Without a custom mapping for <code>ADDRESS</code>, the update would look more
like this:
</p>



<div class="codeblock"><pre>

  PreparedStatement pstmt = con.prepareStatement(
     &quot;UPDATE STORES SET LOCATION.NUM = 1800, &quot; +
     &quot;LOCATION.STREET = 'Artsy_Alley', &quot; +
     &quot;LOCATION.CITY = 'Arden', &quot; +
     &quot;LOCATION.STATE = 'CA', &quot; +
     &quot;LOCATION.ZIP = '94546' &quot; +
     &quot;WHERE STORE_NO = 100003&quot;);
  pstmt.executeUpdate;

</pre></div>

<!-- ****************************************************** -->

<h2><a name="using_your_own_type_map">Using Your Own Type Map</a></h2>

<p>
Up to this point, you have used only the type map associated with a connection for
custom mapping. Ordinarily, that is the only type map most programmers will use.
However, it is also possible to create a type map and pass it to certain methods so
that the driver will use that type map instead of the one associated with the connection.
This allows two different mappings for the same user-defined type (UDT). In fact, it is possible to have
multiple custom mappings for the same UDT, just as long as each mapping is set up
with a class implementing the <code>SQLData</code> interface and an entry in a type map. If
you do not pass a type map to a method that can accept one, the driver will by default
use the type map associated with the connection.
</p>
<p>
There are very few situations that call for using a type map other than the one associated
with a connection. It could be necessary to supply a method with a type map if, for
instance, several programmers working on a JDBC application brought their components
together and were using the same connection. If two or more programmers had created
their own custom mappings for the same SQL UDT, each would need to supply his or her
own type map, thus overriding the connection's type map.
</p>

        </div>
        <div class=NavBit>
            <a target=_top href=sqlstructured.html>&laquo; Previous</a>
            &bull;
            <a target=_top href=../TOC.html>Trail</a>
            &bull;
            <a target=_top href=sqldatalink.html>Next &raquo;</a>
        </div>
    </div>
    <div id=Footer2>
<hr>
<div id=TagNotes>
    <p class="footertext">Problems with the examples? Try <a target="_blank"
        href=../../information/run-examples.html>Compiling and Running
        the Examples: FAQs</a>.
    <br>
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://download.oracle.com/javase/feedback.html">Give
    us your feedback</a>.
    </p>
</div> 

<div id=Footer>
<p class="footertext"><a name="license_info">Your use of this</a> page and all the material on pages under &quot;The Java Tutorials&quot; banner,
and all the material on pages under &quot;The Java Tutorials&quot; banner is subject to the <a href="../../information/license.html">Java SE Tutorial Copyright
and License</a>.
Additionally, any example code contained in any of these Java
Tutorials pages is licensed under the
<a href="http://developers.sun.com/license/berkeley_license.html">Code
Sample License</a>.
</p>
<table border="0" cellspacing="0" cellpadding="5" summary="">
    <tr>
         <td headers="h1" width="20%">
	 <table width="100%" border="0" cellspacing="0" cellpadding="5">
            <tr>
              <td headers="h1" align="center"><img id=duke src=../../images/DukeWave.gif width=55 height=55 alt="duke image"></td>
              <td headers="h2" align="left" valign="middle"><img id=oracle src=../../images/logo_oracle_footer.gif width=100 height=29 alt="Oracle logo"></td>
           </tr>
          </table>
          </td>

          <td width="55%" valign="middle" align="center">
		<p class="footertext"><a href="http://www.oracle.com/us/corporate/index.html">About Oracle</a> | <a href="http://www.oracle.com/technology/index.html">Oracle Technology Network</a> | <a href="https://www.samplecode.oracle.com/servlets/CompulsoryClickThrough?type=TermsOfService">Terms of Service</a></p> 
	 </td>
          <td width="25%" valign="middle" align="right">
      		<p class="footertext">Copyright &copy; 1995, 2011 Oracle and/or its affiliates. All rights reserved.</p>
	 </td>
     </tr>     
</table>
</div>
    </div>
    <div class=PrintHeaders>
        <b>Previous page:</b> Using Structured Objects
        <br><b>Next page:</b> Using Datalink Objects
    </div>

<!-- Start SiteCatalyst code   -->
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code_download.js"></script>
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code.js"></script>
<noscript> 
A browser with JavaScript enabled is required for this page to operate properly.
</noscript>
 
<!-- ********** DO NOT ALTER ANYTHING BELOW THIS LINE ! *********** -->
<!--  Below code will send the info to Omniture server -->
<script language="javascript">var s_code=s.t();if(s_code)document.write(s_code)</script>

 
<!-- End SiteCatalyst code -->

</body>
</html> 
