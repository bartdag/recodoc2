<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html lang="en-US">
    <head>
        <title>Using JoinRowSet Objects (The Java&trade; Tutorials &gt;        
            JDBC(TM) Database Access &gt; JDBC Basics)
</title>

     <meta name="description" content="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform transactions" />
     <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set" />
        
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: center;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
        margin-right: 10px;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }
    
    #Footer2 {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #F90000;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #F90000;
        font-family: sans-serif;
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
    }

    /t

</style>
<script type="text/javascript">
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide the TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }
    
</script>
<noscript> 
A browser with JavaScript enabled is required for this page to operate properly.
</noscript>

    </head>
<body onload="load()">
    <div id=TopBar> <div id=TopBar_tr> <div id=TopBar_tl> <div id=TopBar_br> <div id=TopBar_bl> 
                        <div id=TopBar_right> 
                            <a target="_blank"
                                href="http://java.sun.com/javase/6/download.jsp">Download
                                the JDK</a>
                            <br>
                            <a href="../../search.html" target="_blank">Search the
                                Tutorials</a>
                            <br>
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide the TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class=PrintHeaders>
        <b>Trail:</b> JDBC(TM) Database Access
        <br><b>Lesson:</b> JDBC Basics
    </div>

    <div id=LeftBar class=LeftBar_shown>
        <div id=Contents>
            <div class="linkLESSON"><a href="index.html">JDBC Basics</a></div>
<div class="linkAHEAD"><a href="gettingstarted.html">Getting Started</a></div>
<div class="linkAHEAD"><a href="processingsqlstatements.html">Processing SQL Statements with JDBC</a></div>
<div class="linkAHEAD"><a href="connecting.html">Establishing a Connection</a></div>
<div class="linkAHEAD"><a href="sqldatasources.html">Connecting with DataSource Objects</a></div>
<div class="linkAHEAD"><a href="sqlexception.html">Handling SQLExceptions</a></div>
<div class="linkAHEAD"><a href="tables.html">Setting Up Tables</a></div>
<div class="linkAHEAD"><a href="retrieving.html">Retrieving and Modifying Values from Result Sets</a></div>
<div class="linkAHEAD"><a href="prepared.html">Using Prepared Statements</a></div>
<div class="linkAHEAD"><a href="transactions.html">Using Transactions</a></div>
<div class="linkAHEAD"><a href="rowset.html">Using RowSet Objects</a></div>
<div class="linkAHEAD"><a href="jdbcrowset.html">Using JdbcRowSet Objects</a></div>
<div class="linkAHEAD"><a href="cachedrowset.html">Using CachedRowSetObjects</a></div>
<div class="nolinkAHEAD">Using JoinRowSet Objects</div>
<div class="linkAHEAD"><a href="filteredrowset.html">Using FilteredRowSet Objects</a></div>
<div class="linkAHEAD"><a href="webrowset.html">Using WebRowSet Objects</a></div>
<div class="linkAHEAD"><a href="sqltypes.html">Using Advanced Data Types</a></div>
<div class="linkAHEAD"><a href="blob.html">Using Large Objects</a></div>
<div class="linkAHEAD"><a href="sqlxml.html">Using SQLXML Objects</a></div>
<div class="linkAHEAD"><a href="array.html">Using Array Objects</a></div>
<div class="linkAHEAD"><a href="distinct.html">Using DISTINCT Data Type</a></div>
<div class="linkAHEAD"><a href="sqlstructured.html">Using Structured Objects</a></div>
<div class="linkAHEAD"><a href="sqlcustommapping.html">Using Customized Type Mappings</a></div>
<div class="linkAHEAD"><a href="sqldatalink.html">Using Datalink Objects</a></div>
<div class="linkAHEAD"><a href="sqlrowid.html">Using RowId Objects</a></div>
<div class="linkAHEAD"><a href="storedprocedures.html">Using Stored Procedures</a></div>
<div class="linkAHEAD"><a href="jdbcswing.html">Using JDBC with GUI API</a></div>
</div>
    </div>
    <div id=MainFlow class=MainFlow_indented>
            <span id=BreadCrumbs>
                <a href=../../index.html target=_top>Home Page</a>
                &gt;
                <a href=../index.html target=_top>JDBC(TM) Database Access</a>
                &gt;
                <a href=index.html target=_top>JDBC Basics</a>
            </span>
            <div class=NavBit>
                <a target=_top href=cachedrowset.html>&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target=_top href=../TOC.html>Trail</a>&nbsp;&bull;&nbsp;<a target=_top href=filteredrowset.html>Next&nbsp;&raquo;</a>
            </div>
            <div id=PageTitle><h1>Using JoinRowSet Objects</h1></div>
            <div id=PageContent>
    <p>
      A <code>JoinRowSet</code> implementation lets you create a SQL <code>JOIN</code>
      between <code>RowSet</code> objects when they are not connected to a
      data source. This is important because it saves the
      overhead of having to create one or more connections.</p>



      <p>The following topics are covered:</p>
    

    <ul>
      <li><a href="#creating-joinrowset-object">Creating JoinRowSet Objects</a></li>
      <li><a href="#adding-rowset-objects">Adding RowSet Objects</a></li>
      <li><a href="#managing-match-columns">Managing Match Columns</a></li>

    </ul>
    <p>The <code>JoinRowSet</code> interface is a
      subinterface of the <code>CachedRowSet</code> interface and thereby
      inherits the capabilities of a <code>CachedRowSet</code> object. This
      means that a <code>JoinRowSet</code> object is a disconnected <code>RowSet</code>
      object and can operate without always being connected to a
      data source.
    </p>

    <!-- ******************************************************************* -->


    <h2><a name="creating-joinrowset-object">Creating JoinRowSet Objects</a></h2>

    <p>A <code>JoinRowSet</code> object serves as the holder of a SQL <code>JOIN</code>.
      The following line of code shows to create a
      <code>JoinRowSet</code> object:</p>

    <div class="codeblock"><pre>
JoinRowSet jrs = new JoinRowSetImpl();
</pre></div>

    <p>The variable <code>jrs</code> holds nothing until <code>RowSet</code> objects are added to it.</p>

    <p><strong>Note</strong>: Alternatively, you can use the constructor from the <code>JoinRowSet</code> implementation of your JDBC driver. However, implementations of the <code>RowSet</code> interface will differ from the reference implementation. These implementations will have different names and constructors. For example, the Oracle JDBC driver's implementation of the <code>JoinRowSet</code> interface is named <code>oracle.jdbc.rowset.OracleJoinRowSet</code>.</p>


    <!-- ******************************************************************* -->

    <h2><a name="adding-rowset-objects">Adding RowSet Objects</a></h2>

    <p>
      Any <code>RowSet</code> object can be added to a <code>JoinRowSet</code> object as
      long as it can be part of a SQL <code>JOIN</code>. A <code>JdbcRowSet</code> object,
      which is always connected to its data source, can be added,
      but typically it forms part of a <code>JOIN</code> by operating with the
      data source directly instead of becoming part of a <code>JOIN</code> by
      being added to a <code>JoinRowSet</code> object. The point of providing
      a <code>JoinRowSet</code> implementation is to make it possible for
      disconnected <code>RowSet</code> objects to become part of a <code>JOIN</code>
      relationship.
    </p>

    <p>
      The owner of The Coffee Break chain of coffee houses wants
      to get a list of the coffees he buys from Acme, Inc. In
      order to do this, the owner will have to get information from two
      tables, <code>COFFEES</code> and <code>SUPPLIERS</code>. In the database world before
      <code>RowSet</code> technology, programmers would send
      the following query to the database:
    </p>

    <div class="codeblock"><pre>
String query = "SELECT COFFEES.COF_NAME FROM COFFEES, SUPPLIERS " +
  "WHERE SUPPLIERS.SUP_NAME = Acme.Inc. and " +
  "SUPPLIERS.SUP_ID = COFFEES.SUP_ID";
</pre></div>

    <p>
      In the world of <code>RowSet</code> technology, you can accomplish the
      same result without having to send a query to the data
      source. You can add <code>RowSet</code> objects containing the data in
      the two tables to a <code>JoinRowSet</code> object. Then, because all
      the pertinent data is in the <code>JoinRowSet</code> object, you can
      perform a query on it to get the desired data.
    </p>

    <p>
      The following code fragment from <a href="gettingstarted.html"><code>JoinSample.testJoinRowSet</code></a> creates two <code>CachedRowSet</code>
      objects, <code>coffees</code> populated with the data from the
      table <code>COFFEES</code>, and <code>suppliers</code> populated with the data
      from the table <code>SUPPLIERS</code>. The <code>coffees</code> and <code>suppliers</code> objects have to
      make a connection to the database to execute their commands
      and get populated with data, but after that is done, they do
      not have to reconnect again in order to form a <code>JOIN</code>.
    </p>

<div class="codeblock"><pre>
      coffees = new CachedRowSetImpl();
      coffees.setCommand("SELECT * FROM COFFEES");
      coffees.setUsername(settings.userName);
      coffees.setPassword(settings.password);
      coffees.setUrl(settings.urlString);
      coffees.execute();

      suppliers = new CachedRowSetImpl();
      suppliers.setCommand("SELECT * FROM SUPPLIERS");
      suppliers.setUsername(settings.userName);
      suppliers.setPassword(settings.password);
      suppliers.setUrl(settings.urlString);
      suppliers.execute(); 
</pre></div>

     <h2><a name="managing-match-columns">Managing Match Columns</a></h2>

    <p>
      Looking at the <code>SUPPLIERS</code> table, you can see that Acme, Inc.
      has an identification number of 101. The coffees in the
      table <code>COFFEES</code> with the supplier identification number of
      101 are Colombian and Colombian_Decaf. The joining of
      information from both tables is possible because the two
      tables have the column <code>SUP_ID in common</code>. In JDBC <code>RowSet</code>
      technology, <code>SUP_ID</code>, the column on which the <code>JOIN</code> is based,
      is called the <i>match column</i>.
    </p>

    <p>
      Each <code>RowSet</code> object added to a <code>JoinRowSet</code> object must have a
      match column, the column on which the <code>JOIN</code> is based. There
      are two ways to set the match column for a <code>RowSet</code> object.
      The first way is to pass the match column to the <code>JoinRowSet</code>
      method <code>addRowSet</code>, as shown in the following line of code:
    </p>

    <div class="codeblock"><pre>
jrs.addRowSet(coffees, 2);
</pre></div>

    <p>
      This line of code adds the <code>coffees</code> <code>CachedRowSet</code> to the <code>jrs</code> object and
      sets the second column of <code>coffees</code> (<code>SUP_ID</code>) as the
      match column. The line of code could also have used the
      column name rather that the column number.
    </p>

    <div class="codeblock"><pre>
jrs.addRowSet(coffees, "SUP_ID");
</pre></div>

    <p>
      At this point, <code>jrs</code> has only <code>coffees</code> in it.
      The next <code>RowSet</code> object added to <code>jrs</code> will have to be
      able to form a <code>JOIN</code> with <code>coffees</code>, which is true of
      <code>suppliers</code> because both tables have the column
      SUP_ID. The following line of code adds <code>suppliers</code> to
      <code>jrs</code> and sets the column SUP_ID as the match column.
    </p>

    <div class="codeblock"><pre>
jrs.addRowSet(suppliers, 1);
</pre></div>

    <p>
      Now <code>jrs</code> contains a <code>JOIN</code> between <code>coffees</code> and
      <code>suppliers</code> from which the owner can get the names of
      the coffees supplied by Acme, Inc. Because the code
      did not set the type of <code>JOIN</code>, <code>jrs</code> holds an inner
      JOIN, which is the default. In other words, a row in
      <code>jrs</code> combines a row in <code>coffees</code> and a row in
      <code>suppliers</code>. It holds the columns in <code>coffees</code>
      plus the columns in <code>suppliers</code> for rows in which the
      value in the <code>COFFEES.SUP_ID</code> column matches the value in
      <code>SUPPLIERS.SUP_ID</code>. The following code prints out the names
      of coffees supplied by Acme, Inc., where the <code>String</code> <code>supplierName</code> is equal to <code>Acme, Inc.</code> Note that this is
      possible because the column <code>SUP_NAME</code>, which is from
      <code>suppliers</code>, and <code>COF_NAME</code>, which is from
      <code>coffees</code>, are now both included in the <code>JoinRowSet</code>
      object <code>jrs</code>.
    </p>

<div class="codeblock"><pre>
      System.out.println("Coffees bought from " + supplierName + ": ");
      while (jrs.next()) {
        if (jrs.getString("SUP_NAME").equals(supplierName)) {
          String coffeeName = jrs.getString(1);
          System.out.println("     " + coffeeName);
        }
      }
</pre></div>

    <p>
      This will produce output similar to the following:
    </p>
<div class="codeblock"><pre>
Coffees bought from Acme, Inc.:
     Colombian
     Colombian_Decaf
</pre></div>

    <p>
      The <code>JoinRowSet</code> interface provides constants for setting the
      type of <code>JOIN</code> that will be formed, but currently the only
      type that is implemented is <code>JoinRowSet.INNER_JOIN</code>.
    </p>
        </div>
        <div class=NavBit>
            <a target=_top href=cachedrowset.html>&laquo; Previous</a>
            &bull;
            <a target=_top href=../TOC.html>Trail</a>
            &bull;
            <a target=_top href=filteredrowset.html>Next &raquo;</a>
        </div>
    </div>
    <div id=Footer2>
<hr>
<div id=TagNotes>
    <p class="footertext">Problems with the examples? Try <a target="_blank"
        href=../../information/run-examples.html>Compiling and Running
        the Examples: FAQs</a>.
    <br>
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://download.oracle.com/javase/feedback.html">Give
    us your feedback</a>.
    </p>
</div> 

<div id=Footer>
<p class="footertext"><a name="license_info">Your use of this</a> page and all the material on pages under &quot;The Java Tutorials&quot; banner,
and all the material on pages under &quot;The Java Tutorials&quot; banner is subject to the <a href="../../information/license.html">Java SE Tutorial Copyright
and License</a>.
Additionally, any example code contained in any of these Java
Tutorials pages is licensed under the
<a href="http://developers.sun.com/license/berkeley_license.html">Code
Sample License</a>.
</p>
<table border="0" cellspacing="0" cellpadding="5" summary="">
    <tr>
         <td headers="h1" width="20%">
	 <table width="100%" border="0" cellspacing="0" cellpadding="5">
            <tr>
              <td headers="h1" align="center"><img id=duke src=../../images/DukeWave.gif width=55 height=55 alt="duke image"></td>
              <td headers="h2" align="left" valign="middle"><img id=oracle src=../../images/logo_oracle_footer.gif width=100 height=29 alt="Oracle logo"></td>
           </tr>
          </table>
          </td>

          <td width="55%" valign="middle" align="center">
		<p class="footertext"><a href="http://www.oracle.com/us/corporate/index.html">About Oracle</a> | <a href="http://www.oracle.com/technology/index.html">Oracle Technology Network</a> | <a href="https://www.samplecode.oracle.com/servlets/CompulsoryClickThrough?type=TermsOfService">Terms of Service</a></p> 
	 </td>
          <td width="25%" valign="middle" align="right">
      		<p class="footertext">Copyright &copy; 1995, 2011 Oracle and/or its affiliates. All rights reserved.</p>
	 </td>
     </tr>     
</table>
</div>
    </div>
    <div class=PrintHeaders>
        <b>Previous page:</b> Using CachedRowSetObjects
        <br><b>Next page:</b> Using FilteredRowSet Objects
    </div>

<!-- Start SiteCatalyst code   -->
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code_download.js"></script>
<script language="JavaScript" src="http://www.oracle.com/ocom/groups/systemobject/@mktg_admin/documents/systemobject/s_code.js"></script>
<noscript> 
A browser with JavaScript enabled is required for this page to operate properly.
</noscript>
 
<!-- ********** DO NOT ALTER ANYTHING BELOW THIS LINE ! *********** -->
<!--  Below code will send the info to Omniture server -->
<script language="javascript">var s_code=s.t();if(s_code)document.write(s_code)</script>

 
<!-- End SiteCatalyst code -->

</body>
</html> 
